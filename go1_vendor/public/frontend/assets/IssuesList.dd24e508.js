var y=(x,h,r)=>new Promise((u,l)=>{var m=i=>{try{a(r.next(i))}catch(f){l(f)}},v=i=>{try{a(r.throw(i))}catch(f){l(f)}},a=i=>i.done?u(i.value):Promise.resolve(i.value).then(m,v);a((r=r.apply(x,h)).next())});import{_ as P}from"./AppSidebar.e6135d3f.js";import{u as U,n as w,r as D,c as C,F as N,B as G,o as c,f as d,p as o,g as p,w as b,v as R,q as n,j as V,S as J,T as M,x as q,Q as j,W as A,V as _,X as Q,N as S,Y as W,Z as X,y as Y,$ as Z,a0 as F}from"./vendor.df9a4b93.js";import"./index.ba59bafc.js";const H={class:"flex h-screen w-screen"},K={class:"h-full border-r bg-gray-50"},ee={class:"flex-1 flex flex-col h-full"},se={class:"h-full w-full flex flex-col"},te={class:"mb-2 border-b p-4 flex justify-between"},ae={class:"justify-between"},oe={class:"flex mt-4 mb-4 px-5 justify-between"},le={class:"flex"},ne={class:"ml-6 mt-1"},re={key:0,class:"px-5 flex-1 flex flex-col overflow-auto"},ie={key:0},ce={key:1},de={class:"text-black text-base",style:{"max-width":"170px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",display:"block"}},ue={key:2},pe={class:"font-small text-gray-700 text-base",style:{"max-width":"170px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",display:"block"}},me={class:"w-full mt-2"},fe={class:"flex justify-between items-center"},we={__name:"IssuesList",setup(x){const h=U(),r=w([]),u=w([]),l=D({}),m=w(20),v=w([]),a=C({url:"go1_vendor.apidata.get_issues",params:{field_filters:JSON.stringify(l)},method:"GET"}),i=C({url:"go1_vendor.api.get_issues",method:"GET"}),f=()=>{h.push({name:"Issues"})},T=()=>y(this,null,function*(){const t=(yield i.fetch()).fields;r.value=[],u.value=[],u.value.push({fieldname:"name",fieldtype:"Data",options:null,label:"ID"}),r.value.push({label:"Name",key:"name",width:2}),t.forEach(s=>{s.in_list_view&&r.value.push({label:s.label,key:s.fieldname,width:s.width}),s.in_standard_filter&&u.value.push(s)})}),E=e=>{e&&e.name?h.push({name:"Issues Detail",params:{id:e.name}}):console.error("Row data is invalid:",e)};N(m,e=>{a.limit=e,a.fetch()}),N(l,e=>{a.params={field_filters:JSON.stringify(l)},a.fetch();for(let t in e)(e[t]===null||e[t]==="")&&delete e[t]});const O=e=>{switch(e){case"Draft":return{theme:"red"};case"Overdue":return{theme:"blue"};case"Cancelled":return{theme:"green"};case"Return":return{theme:"orange"};default:return{theme:"gray"}}},$=()=>{Object.keys(l).forEach(e=>{delete l[e]}),a.fetch()},z=e=>({Select:Z,Color:_,Date:F,Link:_,TextEditor:_,Data:_,ReadOnly:"ReadOnlyComponent"})[e.fieldtype]||_,I=e=>({Select:{options:B(e.options),placeholder:e.label},Link:{size:"sm",variant:"subtle",type:"select",placeholder:e.label,options:v.value},Date:{size:"sm",placeholder:e.label},Data:{size:"sm",variant:"subtle",placeholder:e.label},TextEditor:{placeholder:e.label,variant:"subtle"}})[e.fieldtype]||{},B=e=>e?e.split(`
`).map(t=>({label:t,value:t})):[],L=()=>y(this,null,function*(){try{const e=yield fetch('/api/resource/Issue Priority?fields=["name"]');if(!e.ok)throw new Error("Network response was not ok");const t=yield e.json();v.value=t.data.map(s=>s.name)||[]}catch(e){console.error("Error fetching priorities:",e)}});return G(()=>y(this,null,function*(){yield L(),T(),a.fetch()})),(e,t)=>(c(),d("div",H,[o("div",K,[p(P)]),o("div",ee,[o("div",se,[o("div",te,[t[3]||(t[3]=o("div",null,[o("span",null,"Issues")],-1)),o("div",ae,[p(n(V),{variant:"solid",theme:"gray",size:"sm",label:"Button",loading:!1,loadingText:null,disabled:!1,onClick:f},{default:b(()=>t[2]||(t[2]=[R(" + Create ")])),_:1})])]),o("div",oe,[o("div",le,[(c(!0),d(J,null,M(u.value,s=>(c(),d("div",{class:"p-1 w-36",key:s.fieldname},[(c(),q(A(z(s)),j({ref_for:!0},I(s),{modelValue:l[s.fieldname],"onUpdate:modelValue":g=>l[s.fieldname]=g}),null,16,["modelValue","onUpdate:modelValue"]))]))),128))]),o("div",ne,[p(n(V),{variant:"subtle",theme:"gray",size:"sm",onClick:$},{default:b(()=>t[4]||(t[4]=[R(" Reset")])),_:1})])]),n(a).data?(c(),d("div",re,[p(n(W),{class:"flex-1 overflow-auto",columns:r.value,rows:n(a).data,options:{getRowRoute:s=>({name:"Issues Detail",params:{id:s.name}}),selectable:!0,showTooltip:!0,resizeColumn:!0,emptyState:{title:"No records found",description:"Create a new record to get started",button:{label:"New Record",variant:"solid",onClick:()=>console.log("New Record")}}},"row-key":"name",onRowClick:E},{cell:b(({item:s,row:g,column:k})=>[k.key==="status"?(c(),d("div",ie,[p(n(Q),j(O(s),{size:"sm",label:s}),null,16,["label"])])):k.key==="naming_series"?(c(),d("div",ce,[o("span",de,S(s),1)])):(c(),d("div",ue,[o("span",pe,S(s),1)]))]),_:1},8,["columns","rows","options"]),o("div",me,[o("div",fe,[p(n(X),{modelValue:m.value,options:{rowCount:n(a).data.length,totalCount:n(a).data.length},"onUpdate:modelValue":t[0]||(t[0]=s=>m.value=s),onLoadMore:t[1]||(t[1]=s=>n(a).fetch()),class:"w-full"},null,8,["modelValue","options"])])])])):Y("",!0)])])]))}};export{we as default};
