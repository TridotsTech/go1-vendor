var v=(g,y,r)=>new Promise((u,n)=>{var m=i=>{try{p(r.next(i))}catch(a){n(a)}},h=i=>{try{p(r.throw(i))}catch(a){n(a)}},p=i=>i.done?u(i.value):Promise.resolve(i.value).then(m,h);p((r=r.apply(g,y)).next())});import{_ as L}from"./AppSidebar.e6135d3f.js";import{u as Q,n as w,r as M,c as b,F as C,B as P,o as c,f as d,p as o,g as f,M as U,S as D,T as G,x as J,Q as R,q as l,W as A,V as _,w as S,v as F,j as I,X as W,N,Y as X,Z as Y,y as Z,$ as H,a0 as K}from"./vendor.df9a4b93.js";import"./index.ba59bafc.js";const ee={class:"flex h-screen w-screen"},te={class:"h-full border-r bg-gray-50"},se={class:"h-full w-full flex flex-col overflow-auto"},ae={class:"flex-1 flex flex-col h-full"},oe={class:"flex mt-4 mb-4 px-5 justify-between"},le={class:"flex"},ne={class:"ml-6 mt-1"},re={key:0,class:"flex-1 flex flex-col px-5 overflow-auto"},ie={key:0},ce={key:1},de={class:"text-black text-base",style:{"max-width":"170px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",display:"block"}},ue={key:2},pe={class:"font-small text-gray-700 text-base",style:{"max-width":"170px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",display:"block"}},me={class:"w-full mt-2"},fe={class:"flex justify-between items-center"},ye={__name:"RequestForQuotation",setup(g){const y=Q(),r=w([]),u=w([]);let n=M({});const m=w(20),h=w(""),p=b({url:"go1_vendor.apidata.get_test",cache:["true"]});p.fetch();const i=p,a=b({url:"go1_vendor.apidata.get_quotation",params:{field_filters:JSON.stringify(n)},method:"GET"}),V=b({url:"go1_vendor.api.get_request",method:"GET"}),$=()=>v(this,null,function*(){const s=(yield V.fetch()).fields;r.value=[],u.value=[],u.value.push({fieldname:"name",fieldtype:"Data",options:null,label:"ID"}),r.value.push({label:"Name",key:"name",width:2},{label:"Status",key:"status",width:1}),s.forEach(t=>{if(t.in_list_view&&r.value.push({label:t.label,key:t.fieldname,width:t.width}),t.in_standard_filter){if(i.data&&t.fieldname==="vendor")return;u.value.push(t)}})}),E=e=>{e&&e.name?y.push({name:"Request Quotation Details",params:{id:e.name}}):console.error("Row data is invalid:",e)};C(m,e=>{a.limit=e,a.fetch()}),C(n,e=>{a.params={field_filters:JSON.stringify(n)},a.fetch();for(let s in e)(e[s]===null||e[s]==="")&&delete e[s]},{deep:!0});const O=e=>{switch(e){case"Draft":return{theme:"red"};case"Overdue":return{theme:"blue"};case"Cancelled":return{theme:"green"};case"Return":return{theme:"orange"};default:return{theme:"gray"}}},T=()=>{Object.keys(n).forEach(e=>{delete n[e]}),a.fetch()},j=e=>({Select:H,Color:_,Date:K,Link:_,TextEditor:_,Data:_,ReadOnly:"ReadOnlyComponent"})[e.fieldtype]||_,q=e=>({Select:{options:z(e.options),placeholder:e.label},Link:{size:"sm",variant:"subtle",type:"select",placeholder:e.label,options:h.value},Date:{size:"sm",placeholder:e.label},Data:{size:"sm",variant:"subtle",placeholder:e.label},TextEditor:{placeholder:e.label,variant:"subtle"}})[e.fieldtype]||{},z=e=>e?e.split(`
`).map(s=>({label:s,value:s})):[],B=()=>v(this,null,function*(){try{const e=yield fetch('/api/resource/Supplier?fields=["supplier_name"]');if(!e.ok)throw new Error("Network response was not ok");const s=yield e.json();h.value=s.data.map(t=>t.supplier_name)||[]}catch(e){console.error("Error fetching priorities:",e)}});return P(()=>v(this,null,function*(){yield B(),$(),a.fetch()})),(e,s)=>(c(),d("div",ee,[o("div",te,[f(L)]),o("div",se,[s[3]||(s[3]=o("div",{class:"mb-2 border-b p-4"},[o("span",null," Request for Quotations")],-1)),o("div",ae,[U(e.$slots,"default"),o("div",oe,[o("div",le,[(c(!0),d(D,null,G(u.value,t=>(c(),d("div",{class:"p-1 w-36",key:t.fieldname},[(c(),J(A(j(t)),R({ref_for:!0},q(t),{modelValue:l(n)[t.fieldname],"onUpdate:modelValue":x=>l(n)[t.fieldname]=x}),null,16,["modelValue","onUpdate:modelValue"]))]))),128))]),o("div",ne,[f(l(I),{variant:"subtle",theme:"gray",size:"sm",onClick:T},{default:S(()=>s[2]||(s[2]=[F(" Reset ")])),_:1})])]),l(a).data?(c(),d("div",re,[f(l(X),{class:"flex-1 overflow-auto",columns:r.value,rows:l(a).data,options:{getRowRoute:t=>({name:"Request Quotation Details",params:{id:t.name}}),selectable:!0,showTooltip:!0,resizeColumn:!0,emptyState:{title:"No records found",description:"Create a new record to get started",button:{label:"New Record",variant:"solid",onClick:()=>console.log("New Record")}}},"row-key":"name",onRowClick:E},{cell:S(({item:t,row:x,column:k})=>[k.key==="status"?(c(),d("div",ie,[f(l(W),R(O(t),{size:"sm",label:t}),null,16,["label"])])):k.key==="naming_series"?(c(),d("div",ce,[o("span",de,N(t),1)])):(c(),d("div",ue,[o("span",pe,N(t),1)]))]),_:1},8,["columns","rows","options"]),o("div",me,[o("div",fe,[f(l(Y),{modelValue:m.value,options:{rowCount:l(a).data.length,totalCount:l(a).data.length},"onUpdate:modelValue":s[0]||(s[0]=t=>m.value=t),onLoadMore:s[1]||(s[1]=t=>l(a).fetch()),class:"w-full"},null,8,["modelValue","options"])])])])):Z("",!0)])])]))}};export{ye as default};
