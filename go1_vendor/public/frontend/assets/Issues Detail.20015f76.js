var E=(B,U,c)=>new Promise((j,v)=>{var y=u=>{try{g(c.next(u))}catch(p){v(p)}},x=u=>{try{g(c.throw(u))}catch(p){v(p)}},g=u=>u.done?j(u.value):Promise.resolve(u.value).then(y,x);g((c=c.apply(B,U)).next())});import{_ as le}from"./AppSidebar.e6135d3f.js";import{u as oe,a1 as ae,n as l,r as ne,c as F,B as ie,F as ue,e as de,o,f as d,p as s,g as O,w as re,v as pe,q as n,N as r,y as S,x as m,j as $,V as _,a2 as me}from"./vendor.df9a4b93.js";import"./index.ba59bafc.js";const ce={class:"flex h-screen w-screen"},ve={class:"h-full border-r bg-gray-50"},fe={class:"flex-1 flex flex-col h-full overflow-auto"},ye={class:"mb-2 border-b p-1"},xe={class:"flex flex-1 items-center h-12"},_e={key:0},ge={class:"main-content justify-items-center grid grid-cols-1 py-10 h-[550px]"},be={class:"grid grid-cols-1 content-start gap-3 m-2 w-8/12 bg-white border rounded-md pb-5"},ke={class:"px-3 py-3 border-b"},Ve={class:"flex justify-between items-center"},we={class:"text-xl text-cyan-600 font-semibold"},je={class:"float-right mb-1"},he={class:"grid grid-cols-1 p-3"},Ce={class:"grid grid-cols-2 md:grid-cols-3 gap-3 justify-items-stretch text-gray-800"},Ee={class:"flex flex-col gap-1"},Oe={key:1,class:"text-sm font-semibold py-2"},Se={class:"flex flex-col gap-1"},Ue={key:1,class:"text-sm font-semibold py-2"},De={key:0,class:"flex flex-col gap-1"},Ie={key:1,class:"text-sm font-semibold py-2"},Ne={class:"flex flex-col gap-1"},Re={key:1,class:"text-sm font-semibold py-2"},Te={class:"flex flex-col gap-1"},$e={key:1,class:"text-sm font-semibold py-2"},Be={class:"flex flex-col gap-1"},Pe={key:1,class:"text-sm font-semibold py-2"},ze={class:"flex flex-col gap-1"},qe={key:1,class:"text-sm font-semibold py-2"},He={class:"flex flex-col gap-1"},Je={key:1,class:"text-sm font-semibold py-2"},Qe={class:"flex flex-col gap-1"},Ae={key:1,class:"text-sm font-semibold py-2"},Fe={key:0,class:"justify-end mt-3 flex gap-4"},We={__name:"Issues Detail",setup(B){const U=oe(),c=ae(),j=l(""),v=l(""),y=l(""),x=l(""),g=l(""),u=l(""),p=l(""),P=l(""),D=l(""),I=l(""),b=l(""),k=l(""),N=l(""),R=l("");l("");const V=l(""),T=l(""),w=l(""),i=l(!1),G=ne({}),z=l([]),q=l([]),H=l([]);let h=l({});const J=()=>{h.value=c.params,h=h.value},L=(f=1e3)=>E(this,null,function*(){try{const e=yield fetch(`/api/resource/Supplier?fields=["supplier_name"]&limit=${f}`),t=yield fetch('/api/resource/Issue Priority?fields=["name"]'),a=yield fetch('/api/resource/Company?fields=["company_name"]');if(!t.ok)throw new Error("Network response was not ok");const ee=yield t.json(),se=yield e.json(),te=yield a.json();z.value=se.data.map(C=>C.supplier_name)||[],q.value=ee.data.map(C=>C.name)||[],H.value=te.data.map(C=>C.company_name)||[]}catch(e){console.error("Error fetching Country:",e)}}),Q=F({url:"go1_vendor.apidata.get_test",cache:["true"]});Q.fetch();const M=Q,K=F({url:"go1_vendor.apidata.get_issues",params:{field_filters:JSON.stringify(G)},method:"GET"}),A=()=>E(this,null,function*(){try{const f=c.params.id,t=(yield K.fetch()).find(a=>a.name===f);t&&(j.value=t.name,w.value=t.custom_supplier,v.value=t.subject,y.value=t.status,x.value=t.priority,g.value=t.address_line2,u.value=t.issue_type,p.value=t.description,P.value=t.issue_type,D.value=t.first_responded_on,I.value=t.resolution_details,b.value=t.opening_date,k.value=t.opening_time,N.value=t.lead,R.value=t.project,V.value=t.company,T.value=t.email_account,console.log("hit",t))}catch(f){console.error("Error fetching order details:",f)}}),W=[{label:"Open",value:"Open"},{label:"Closed",value:"Closed"},{label:"Replied",value:"Replied"},{label:"On Hold",value:"On Hold"},{label:"Resolved",value:"Resolved"}],X=()=>{i.value=!0},Y=()=>{i.value=!1,A()},Z=()=>E(this,null,function*(){const f=c.params.id;if(!f)return;const e={subject:v.value,status:y.value,priority:x.value,description:p.value,custom_supplier:w.value,issue_type:u.value,first_responded_on:D.value,resolution_details:I.value,opening_date:b.value,opening_time:k.value,lead:N.value,project:R.value,company:V.value,email_account:T.value};try{if(!(yield fetch(`/api/resource/Issue/${f}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw new Error("Error updating Issue");j.value=e.subject,v.value=e.subject,y.value=e.status,x.value=e.priority,w.value=e.custom_supplier,g.value=e.address_line2,p.value=e.description,P.value=e.issue_type,D.value=e.first_responded_on,I.value=e.resolution_details,b.value=e.opening_date,k.value=e.opening_time,N.value=e.lead,R.value=e.project,V.value=e.company,T.value=e.email_account,i.value=!1,U.push({name:"IssuesList"})}catch(t){console.error("Error updating issue:",t)}});return ie(()=>E(this,null,function*(){yield L(),A(),J()})),ue(()=>c.fullPath,()=>{J()}),(f,e)=>{const t=de("router-link");return o(),d("div",ce,[s("div",ve,[O(le)]),s("div",fe,[s("div",ye,[s("div",xe,[O(t,{to:"/Issues"},{default:re(()=>[e[9]||(e[9]=s("span",{class:"ml-3"},"Issues ",-1)),e[10]||(e[10]=pe("/ ")),n(h)?(o(),d("span",_e,r(n(h).id),1)):S("",!0)]),_:1})])]),s("div",ge,[s("div",be,[s("div",ke,[s("div",Ve,[s("span",we,r(j.value),1),s("div",je,[i.value?S("",!0):(o(),m(n($),{key:0,variant:"solid",theme:"gray",size:"md",label:"Edit",disabled:!1,onClick:X}))])])]),s("div",he,[e[27]||(e[27]=s("div",{class:"mb-5 text-lg font-medium"},[s("h1",null,"Details:")],-1)),s("div",Ce,[s("div",Ee,[e[11]||(e[11]=s("span",{class:"text-gray-600 text-sm"},"Subject",-1)),i.value?(o(),m(n(_),{key:0,modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=a=>v.value=a),class:"text-sm font-semibold rounded-md p-1"},null,8,["modelValue"])):(o(),d("span",Oe,r(v.value),1)),e[12]||(e[12]=s("br",null,null,-1))]),s("div",Se,[e[13]||(e[13]=s("span",{class:"text-gray-600 text-sm"},"Status",-1)),i.value?(o(),m(n(_),{key:0,type:"select",modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=a=>y.value=a),options:W,class:"text-sm font-semibold rounded-md p-1"},null,8,["modelValue"])):(o(),d("span",Ue,r(y.value),1)),e[14]||(e[14]=s("br",null,null,-1))]),n(M).data?S("",!0):(o(),d("div",De,[e[15]||(e[15]=s("span",{class:"text-gray-600 text-sm"},"Supplier",-1)),i.value?(o(),m(n(_),{key:0,type:"select",modelValue:w.value,"onUpdate:modelValue":e[2]||(e[2]=a=>w.value=a),options:z.value,class:"text-sm font-semibold rounded-md p-1"},null,8,["modelValue","options"])):(o(),d("span",Ie,r(w.value),1))])),s("div",Ne,[e[16]||(e[16]=s("span",{class:"text-gray-600 text-sm"},"Priority",-1)),i.value?(o(),m(n(_),{key:0,type:"select",modelValue:x.value,"onUpdate:modelValue":e[3]||(e[3]=a=>x.value=a),options:q.value,class:"text-sm font-semibold rounded-md p-1"},null,8,["modelValue","options"])):(o(),d("span",Re,r(x.value),1)),e[17]||(e[17]=s("br",null,null,-1))]),s("div",Te,[e[18]||(e[18]=s("span",{class:"text-gray-600 text-sm"},"Issue Type",-1)),i.value?(o(),m(n(_),{key:0,modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=a=>u.value=a),class:"text-sm font-semibold rounded-md p-1"},null,8,["modelValue"])):(o(),d("span",$e,r(u.value),1)),e[19]||(e[19]=s("br",null,null,-1))]),s("div",Be,[e[20]||(e[20]=s("span",{class:"text-gray-600 text-sm"},"Description",-1)),i.value?(o(),m(n(me),{key:0,modelValue:p.value,"onUpdate:modelValue":e[5]||(e[5]=a=>p.value=a),class:"text-sm font-semibold rounded-md p-1"},null,8,["modelValue"])):(o(),d("span",Pe,r(p.value),1)),e[21]||(e[21]=s("br",null,null,-1))]),s("div",ze,[e[22]||(e[22]=s("span",{class:"text-gray-600 text-sm"},"Opening Date",-1)),i.value?(o(),m(n(_),{key:0,modelValue:b.value,"onUpdate:modelValue":e[6]||(e[6]=a=>b.value=a),class:"text-sm font-semibold rounded-md p-1"},null,8,["modelValue"])):(o(),d("span",qe,r(b.value),1))]),s("div",He,[e[23]||(e[23]=s("span",{class:"text-gray-600 text-sm"},"Opening Time",-1)),i.value?(o(),m(n(_),{key:0,modelValue:k.value,"onUpdate:modelValue":e[7]||(e[7]=a=>k.value=a),class:"text-sm font-semibold rounded-md p-1"},null,8,["modelValue"])):(o(),d("span",Je,r(k.value),1)),e[24]||(e[24]=s("br",null,null,-1))]),s("div",Qe,[e[25]||(e[25]=s("span",{class:"text-gray-600 text-sm"},"Company",-1)),i.value?(o(),m(n(_),{key:0,type:"select",modelValue:V.value,"onUpdate:modelValue":e[8]||(e[8]=a=>V.value=a),options:H.value,class:"text-sm font-semibold rounded-md p-1"},null,8,["modelValue","options"])):(o(),d("span",Ae,r(V.value),1))]),e[26]||(e[26]=s("div",null,null,-1))]),i.value?(o(),d("div",Fe,[O(n($),{variant:"subtle",theme:"gray",size:"md",label:"Discard",disabled:!1,onClick:Y}),O(n($),{variant:"solid",theme:"gray",size:"md",label:"Submit",disabled:!1,onClick:Z})])):S("",!0)])])])])])}}};export{We as default};
