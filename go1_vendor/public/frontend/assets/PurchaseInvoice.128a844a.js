var g=(C,x,r)=>new Promise((p,l)=>{var f=n=>{try{u(r.next(n))}catch(_){l(_)}},w=n=>{try{u(r.throw(n))}catch(_){l(_)}},u=n=>n.done?p(n.value):Promise.resolve(n.value).then(f,w);u((r=r.apply(C,x)).next())});import{_ as P}from"./AppSidebar.e6135d3f.js";import{u as M,n as h,r as U,c as k,F as S,B as G,o as c,f as d,p as a,g as v,M as J,S as q,T as A,x as D,Q as N,W as Q,V as y,w as R,v as W,q as i,j as X,X as Y,N as V,Y as Z,Z as F,y as H,$ as K,a0 as ee}from"./vendor.df9a4b93.js";import"./index.ba59bafc.js";const te={class:"flex h-screen w-screen"},se={class:"h-full border-r bg-gray-50"},ae={class:"h-full w-full flex flex-col overflow-auto"},oe={class:"flex-1 flex flex-col h-full"},le={class:"flex mt-4 mb-4 px-5 justify-between"},ne={class:"flex"},re={class:"ml-6 mt-1"},ie={key:0,class:"flex-1 flex flex-col px-5 overflow-auto"},ce={key:0},de={key:1},pe={class:"text-black text-base",style:{"max-width":"170px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",display:"block"}},ue={key:2},me={class:"font-small text-gray-700 text-base",style:{"max-width":"170px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",display:"block"}},fe={class:"w-full mt-2"},_e={class:"flex justify-between items-center"},be={__name:"PurchaseInvoice",setup(C){const x=M(),r=h([]),p=h([]),l=U({}),f=h(20),w=h(""),u=h(""),n=k({url:"go1_vendor.apidata.get_test",cache:["true"]});n.fetch();const _=n,o=k({url:"go1_vendor.apidata.get_purchaseinvoice",params:{field_filters:JSON.stringify(l)},method:"GET"}),$=k({url:"go1_vendor.api.get_invoice",method:"GET"}),j=()=>g(this,null,function*(){const s=(yield $.fetch()).fields;r.value=[],p.value=[],p.value.push({fieldname:"name",fieldtype:"Data",options:null,label:"ID"}),r.value.push({label:"Name",key:"name",width:2},{label:"Status",key:"status",width:1}),s.forEach(t=>{if(t.in_list_view&&r.value.push({label:t.label,key:t.fieldname,width:t.width}),t.in_standard_filter){if(_.data&&t.fieldname==="supplier")return;p.value.push(t)}})}),E=e=>{e&&e.name?x.push({name:"Supplier Invoice Details",params:{id:e.name}}):console.error("Row data is invalid:",e)};S(f,e=>{o.limit=e,o.fetch()}),S(l,e=>{o.params={field_filters:JSON.stringify(l)},o.fetch();for(let s in e)(e[s]===null||e[s]==="")&&delete e[s]},{deep:!0});const O=e=>{switch(e){case"Draft":return{theme:"red"};case"Overdue":return{theme:"blue"};case"Cancelled":return{theme:"green"};case"Return":return{theme:"orange"};default:return{theme:"gray"}}},T=()=>{Object.keys(l).forEach(e=>{delete l[e]}),o.fetch()},z=e=>({Select:K,Color:y,Date:ee,Link:y,TextEditor:y,Data:y,ReadOnly:"ReadOnlyComponent"})[e.fieldtype]||y,B=e=>({Select:{options:I(e.options),placeholder:e.label},Link:{size:"sm",variant:"subtle",type:"select",placeholder:e.label,options:e.fieldname=="supplier"?w.value:u.value},Date:{size:"sm",placeholder:e.label},Data:{size:"sm",variant:"subtle",placeholder:e.label},TextEditor:{placeholder:e.label,variant:"subtle"}})[e.fieldtype]||{},I=e=>e?e.split(`
`).map(s=>({label:s,value:s})):[],L=()=>g(this,null,function*(){try{const e=yield fetch('/api/resource/Supplier?fields=["supplier_name"]'),s=yield fetch('/api/resource/Company?fields=["company_name"]');if(!e.ok)throw new Error("Network response was not ok");const t=yield e.json(),b=yield s.json();w.value=t.data.map(m=>m.supplier_name)||[],u.value=b.data.map(m=>m.company_name)||[]}catch(e){console.error("Error fetching priorities:",e)}});return G(()=>g(this,null,function*(){yield L(),j(),o.fetch()})),(e,s)=>(c(),d("div",te,[a("div",se,[v(P)]),a("div",ae,[s[3]||(s[3]=a("div",{class:"mb-2 border-b p-4"},[a("span",null," Supplier Invoices")],-1)),a("div",oe,[J(e.$slots,"default"),a("div",le,[a("div",ne,[(c(!0),d(q,null,A(p.value,t=>(c(),d("div",{class:"p-1 w-36",key:t.fieldname},[(c(),D(Q(z(t)),N({ref_for:!0},B(t),{modelValue:l[t.fieldname],"onUpdate:modelValue":b=>l[t.fieldname]=b}),null,16,["modelValue","onUpdate:modelValue"]))]))),128))]),a("div",re,[v(i(X),{variant:"subtle",theme:"gray",size:"sm",onClick:T},{default:R(()=>s[2]||(s[2]=[W(" Reset ")])),_:1})])]),i(o).data?(c(),d("div",ie,[v(i(Z),{class:"flex-1 overflow-auto",columns:r.value,rows:i(o).data,options:{getRowRoute:t=>({name:"Supplier Invoice Details",params:{id:t.name}}),selectable:!0,showTooltip:!0,resizeColumn:!0,emptyState:{title:"No records found",description:"Create a new record to get started",button:{label:"New Record",variant:"solid",onClick:()=>console.log("New Record")}}},"row-key":"name",onRowClick:E},{cell:R(({item:t,row:b,column:m})=>[m.key==="status"?(c(),d("div",ce,[v(i(Y),N(O(t),{size:"sm",label:t}),null,16,["label"])])):m.key==="naming_series"?(c(),d("div",de,[a("span",pe,V(t),1)])):(c(),d("div",ue,[a("span",me,V(t),1)]))]),_:1},8,["columns","rows","options"]),a("div",fe,[a("div",_e,[v(i(F),{modelValue:f.value,options:{rowCount:i(o).data.length,totalCount:i(o).data.length},"onUpdate:modelValue":s[0]||(s[0]=t=>f.value=t),onLoadMore:s[1]||(s[1]=t=>i(o).fetch()),class:"w-full"},null,8,["modelValue","options"])])])])):H("",!0)])])]))}};export{be as default};
